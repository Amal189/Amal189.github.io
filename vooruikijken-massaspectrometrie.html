<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Vooruikijken: Massaspectrometrie | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Vooruikijken: Massaspectrometrie | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Vooruikijken: Massaspectrometrie | _main.knit" />
  
  
  

<meta name="author" content="Jasmijnbloem" />


<meta name="date" content="2025-05-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="curriculum-vitae.html"/>
<link rel="next" href="guerilla-analytics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welkom</a></li>
<li class="chapter" data-level="2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html"><i class="fa fa-check"></i><b>2</b> Curriculum Vitae</a>
<ul>
<li class="chapter" data-level="2.1" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#curriculum-vitae-nederlands"><i class="fa fa-check"></i><b>2.1</b> Curriculum Vitae (Nederlands)</a></li>
<li class="chapter" data-level="2.2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#curriculum-vitae-english-version"><i class="fa fa-check"></i><b>2.2</b> Curriculum Vitae (English Version)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html"><i class="fa fa-check"></i><b>3</b> Vooruikijken: Massaspectrometrie</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#toekomstbeeld-en-motivatie"><i class="fa fa-check"></i><b>3.1</b> 1. Toekomstbeeld en motivatie</a></li>
<li class="chapter" data-level="3.2" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#planning"><i class="fa fa-check"></i><b>3.2</b> 2. Planning</a></li>
<li class="chapter" data-level="3.3" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#inleiding"><i class="fa fa-check"></i><b>3.3</b> 3. Inleiding</a></li>
<li class="chapter" data-level="3.4" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#hoe-ziet-het-systeem-eruit"><i class="fa fa-check"></i><b>3.4</b> 4. Hoe ziet het systeem eruit?</a></li>
<li class="chapter" data-level="3.5" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#termen-in-de-massaspectrometrie"><i class="fa fa-check"></i><b>3.5</b> Termen in de massaspectrometrie</a></li>
<li class="chapter" data-level="3.6" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#tools-en-packages"><i class="fa fa-check"></i><b>3.6</b> Tools en packages</a></li>
<li class="chapter" data-level="3.7" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#uitwerking-met-msdata"><i class="fa fa-check"></i><b>3.7</b> 4. Uitwerking met msdata</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#introductie-bestandsformaat-en-voorbeelddata"><i class="fa fa-check"></i><b>3.7.1</b> Introductie bestandsformaat en voorbeelddata</a></li>
<li class="chapter" data-level="3.7.2" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#hoe-ik-de-data-inlees"><i class="fa fa-check"></i><b>3.7.2</b> Hoe ik de data inlees</a></li>
<li class="chapter" data-level="3.7.3" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#verkennen-van-spectra"><i class="fa fa-check"></i><b>3.7.3</b> Verkennen van spectra</a></li>
<li class="chapter" data-level="3.7.4" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#plotten-van-chromatogram"><i class="fa fa-check"></i><b>3.7.4</b> Plotten van chromatogram</a></li>
<li class="chapter" data-level="3.7.5" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#filteren-op-retentietijd-en-ms-level"><i class="fa fa-check"></i><b>3.7.5</b> Filteren op retentietijd en MS-level</a></li>
<li class="chapter" data-level="3.7.6" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#gemiddeld-spectrum-handmatig-berekenen-en-plotten"><i class="fa fa-check"></i><b>3.7.6</b> Gemiddeld spectrum handmatig berekenen en plotten</a></li>
<li class="chapter" data-level="3.7.7" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#pca-op-voorbeelddata"><i class="fa fa-check"></i><b>3.7.7</b> PCA op voorbeelddata</a></li>
<li class="chapter" data-level="3.7.8" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#t-sne-visualisatie-van-spectra"><i class="fa fa-check"></i><b>3.7.8</b> t-SNE visualisatie van spectra</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#uitwerking-met-de-prolocdata"><i class="fa fa-check"></i><b>3.8</b> 5. Uitwerking met de pRolocdata</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-1-installatie-en-laden-van-benodigde-pakketten"><i class="fa fa-check"></i><b>3.8.1</b> Stap 1: Installatie en laden van benodigde pakketten</a></li>
<li class="chapter" data-level="3.8.2" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-2-laad-de-dunkley2006-dataset"><i class="fa fa-check"></i><b>3.8.2</b> Stap 2: Laad de dunkley2006 dataset</a></li>
<li class="chapter" data-level="3.8.3" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-3-eerste-verkenning-van-de-dataset"><i class="fa fa-check"></i><b>3.8.3</b> Stap 3: Eerste verkenning van de dataset</a></li>
<li class="chapter" data-level="3.8.4" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-4-pca-plot-van-eiwitexpressie"><i class="fa fa-check"></i><b>3.8.4</b> Stap 4: PCA-plot van eiwitexpressie</a></li>
<li class="chapter" data-level="3.8.5" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-5-t-sne-voor-niet-lineaire-visualisatie"><i class="fa fa-check"></i><b>3.8.5</b> Stap 5: t-SNE voor niet-lineaire visualisatie</a></li>
<li class="chapter" data-level="3.8.6" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#stap-6-heatmap-van-eiwitexpressie"><i class="fa fa-check"></i><b>3.8.6</b> Stap 6: Heatmap van eiwitexpressie</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#zelf-grafieken-maken"><i class="fa fa-check"></i><b>3.9</b> 6. Zelf grafieken maken</a></li>
<li class="chapter" data-level="3.10" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#reflectie"><i class="fa fa-check"></i><b>3.10</b> Reflectie:</a></li>
<li class="chapter" data-level="3.11" data-path="vooruikijken-massaspectrometrie.html"><a href="vooruikijken-massaspectrometrie.html#bronnen"><i class="fa fa-check"></i><b>3.11</b> Bronnen</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="guerilla-analytics.html"><a href="guerilla-analytics.html"><i class="fa fa-check"></i><b>4</b> Guerilla analytics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="guerilla-analytics.html"><a href="guerilla-analytics.html#daur2_rnaseq"><i class="fa fa-check"></i><b>4.1</b> DAUR2_RNAseq</a></li>
<li class="chapter" data-level="4.2" data-path="guerilla-analytics.html"><a href="guerilla-analytics.html#portfolio-van-jasmijnbloem"><i class="fa fa-check"></i><b>4.2</b> Portfolio van Jasmijnbloem</a></li>
<li class="chapter" data-level="4.3" data-path="guerilla-analytics.html"><a href="guerilla-analytics.html#referentie"><i class="fa fa-check"></i><b>4.3</b> Referentie</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html"><i class="fa fa-check"></i><b>5</b> Reproduceerbare Analyse 1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#c.elegans-toxiciteitsexperiment"><i class="fa fa-check"></i><b>5.1</b> C.elegans toxiciteitsexperiment</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-1-data-opslaan-en-inlezen"><i class="fa fa-check"></i><b>5.1.1</b> Stap 1: Data opslaan en inlezen</a></li>
<li class="chapter" data-level="5.1.2" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-2-inspecteren-van-de-datatypes"><i class="fa fa-check"></i><b>5.1.2</b> Stap 2: Inspecteren van de datatypes</a></li>
<li class="chapter" data-level="5.1.3" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-3-datatype-corrigeren"><i class="fa fa-check"></i><b>5.1.3</b> Stap 3: Datatype corrigeren</a></li>
<li class="chapter" data-level="5.1.4" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-4-scatter-plot-maken"><i class="fa fa-check"></i><b>5.1.4</b> Stap 4: Scatter plot maken</a></li>
<li class="chapter" data-level="5.1.5" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-5-normalizeren-van-de-data-voor-de-negatieve-controle"><i class="fa fa-check"></i><b>5.1.5</b> Stap 5: Normalizeren van de data voor de negatieve controle</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stappenplan-voor-dose-response-analyse"><i class="fa fa-check"></i><b>5.2</b> Stappenplan voor dose-response analyse</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-1-installeer-en-laad-het-drc-pakket"><i class="fa fa-check"></i><b>5.2.1</b> Stap 1: Installeer en laad het drc-pakket</a></li>
<li class="chapter" data-level="5.2.2" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-2-filter-de-data-verwijder-nas-en-incomplete-observaties"><i class="fa fa-check"></i><b>5.2.2</b> Stap 2: Filter de data (verwijder NA’s en incomplete observaties)</a></li>
<li class="chapter" data-level="5.2.3" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-3-dosis-respons-modellen-fitten"><i class="fa fa-check"></i><b>5.2.3</b> Stap 3: Dosis-respons modellen fitten</a></li>
<li class="chapter" data-level="5.2.4" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-4-bepaal-de-ic50-waarden"><i class="fa fa-check"></i><b>5.2.4</b> Stap 4: Bepaal de IC50-waarden</a></li>
<li class="chapter" data-level="5.2.5" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-5-overzichtstabel-van-ic50-waarden"><i class="fa fa-check"></i><b>5.2.5</b> Stap 5: Overzichtstabel van IC50-waarden</a></li>
<li class="chapter" data-level="5.2.6" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-6-dosis-respons-curves-combineren-in-één-figuur"><i class="fa fa-check"></i><b>5.2.6</b> Stap 6: Dosis-respons curves combineren in één figuur</a></li>
<li class="chapter" data-level="5.2.7" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#stap-7-eén-curve-per-stof-optioneel"><i class="fa fa-check"></i><b>5.2.7</b> Stap 7: Eén curve per stof (optioneel)</a></li>
<li class="chapter" data-level="5.2.8" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#conclusie"><i class="fa fa-check"></i><b>5.2.8</b> conclusie</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#wetenschappelijke-referenties"><i class="fa fa-check"></i><b>5.3</b> Wetenschappelijke Referenties</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#ethanol-en-effecten-op-c.-elegans-voortplanting"><i class="fa fa-check"></i><b>5.3.1</b> 1. <strong>Ethanol en effecten op <em>C. elegans</em> voortplanting</strong>:</a></li>
<li class="chapter" data-level="5.3.2" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#decaan-en-naphthaleen-als-toxische-stoffen"><i class="fa fa-check"></i><b>5.3.2</b> 2. <strong>Decaan en naphthaleen als toxische stoffen</strong>:</a></li>
<li class="chapter" data-level="5.3.3" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#dosis-responscurves-en-ic50-waarde-bepaling"><i class="fa fa-check"></i><b>5.3.3</b> 3. <strong>Dosis-responscurves en IC50-waarde bepaling</strong>:</a></li>
<li class="chapter" data-level="5.3.4" data-path="reproduceerbare-analyse-1.html"><a href="reproduceerbare-analyse-1.html#s-medium-als-controle-in-biologische-experimenten"><i class="fa fa-check"></i><b>5.3.4</b> 4. <strong>S-medium als controle in biologische experimenten</strong>:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><i class="fa fa-check"></i><b>6</b> Reproduceerbare Analyse 2: Artikel beoordelen op reproduceerbaarheid</a>
<ul>
<li class="chapter" data-level="6.1" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#artikelinformatie"><i class="fa fa-check"></i><b>6.1</b> Artikelinformatie</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#onderzoeksvraag-en-doel-van-het-onderzoek"><i class="fa fa-check"></i><b>6.1.1</b> Onderzoeksvraag en doel van het onderzoek</a></li>
<li class="chapter" data-level="6.1.2" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#korte-samenvatting-van-methode-en-resultaten"><i class="fa fa-check"></i><b>6.1.2</b> Korte samenvatting van methode en resultaten</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#beoordeling-van-de-reproduceerbaarheid"><i class="fa fa-check"></i><b>6.2</b> Beoordeling van de reproduceerbaarheid</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#doel-van-de-studie"><i class="fa fa-check"></i><b>6.2.1</b> 1. Doel van de studie</a></li>
<li class="chapter" data-level="6.2.2" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#data-beschikbaarheid"><i class="fa fa-check"></i><b>6.2.2</b> 2. Data beschikbaarheid</a></li>
<li class="chapter" data-level="6.2.3" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#locatie-van-de-data"><i class="fa fa-check"></i><b>6.2.3</b> 3. Locatie van de data</a></li>
<li class="chapter" data-level="6.2.4" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#plaats-van-de-studie"><i class="fa fa-check"></i><b>6.2.4</b> 4. Plaats van de studie</a></li>
<li class="chapter" data-level="6.2.5" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#informatie-over-auteurs"><i class="fa fa-check"></i><b>6.2.5</b> 5. Informatie over auteurs</a></li>
<li class="chapter" data-level="6.2.6" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#ethische-verklaring"><i class="fa fa-check"></i><b>6.2.6</b> 6. Ethische verklaring</a></li>
<li class="chapter" data-level="6.2.7" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#financiering"><i class="fa fa-check"></i><b>6.2.7</b> 7. Financiering</a></li>
<li class="chapter" data-level="6.2.8" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#code-beschikbaarheid"><i class="fa fa-check"></i><b>6.2.8</b> 8. Code beschikbaarheid</a></li>
<li class="chapter" data-level="6.2.9" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#samenvattende-tabel"><i class="fa fa-check"></i><b>6.2.9</b> Samenvattende tabel</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#reproduceerbaarheid-van-gedeelde-r-code"><i class="fa fa-check"></i><b>6.3</b> Reproduceerbaarheid van gedeelde R code</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#beschrijving-en-beoordeling-van-de-code"><i class="fa fa-check"></i><b>6.3.1</b> Beschrijving en beoordeling van de code</a></li>
<li class="chapter" data-level="6.3.2" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#reproduceerbaarheid-en-problemen"><i class="fa fa-check"></i><b>6.3.2</b> Reproduceerbaarheid en problemen</a></li>
<li class="chapter" data-level="6.3.3" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#aangepaste-code-werkt-wel"><i class="fa fa-check"></i><b>6.3.3</b> Aangepaste code (werkt wel):</a></li>
<li class="chapter" data-level="6.3.4" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#beordeling-op-reproduceerbaarheid"><i class="fa fa-check"></i><b>6.3.4</b> Beordeling op reproduceerbaarheid</a></li>
<li class="chapter" data-level="6.3.5" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#resultaat"><i class="fa fa-check"></i><b>6.3.5</b> Resultaat</a></li>
<li class="chapter" data-level="6.3.6" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#evaluatie-korte-evluatie-op-de-r-code"><i class="fa fa-check"></i><b>6.3.6</b> Evaluatie korte evluatie op de R code</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html"><a href="reproduceerbare-analyse-2-artikel-beoordelen-op-reproduceerbaarheid.html#conclusie-1"><i class="fa fa-check"></i><b>6.4</b> Conclusie</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="structured-query-language.html"><a href="structured-query-language.html"><i class="fa fa-check"></i><b>7</b> Structured Query Language</a>
<ul>
<li class="chapter" data-level="7.1" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-1-laad-de-libraries"><i class="fa fa-check"></i><b>7.1</b> Stap 1: Laad de libraries</a></li>
<li class="chapter" data-level="7.2" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-2-data-inlezen-in-r"><i class="fa fa-check"></i><b>7.2</b> Stap 2: Data inlezen in R</a></li>
<li class="chapter" data-level="7.3" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-3-data-controleren."><i class="fa fa-check"></i><b>7.3</b> Stap 3: Data controleren.</a></li>
<li class="chapter" data-level="7.4" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-4-zet-de-data-in-tidy-format"><i class="fa fa-check"></i><b>7.4</b> Stap 4: Zet de data in tidy format</a></li>
<li class="chapter" data-level="7.5" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-5-harmoniseer-landenamen"><i class="fa fa-check"></i><b>7.5</b> Stap 5: Harmoniseer landenamen</a></li>
<li class="chapter" data-level="7.6" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-6-voeg-datasets-samen"><i class="fa fa-check"></i><b>7.6</b> Stap 6: Voeg datasets samen</a></li>
<li class="chapter" data-level="7.7" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-7-zet-data-in-een-sql-database"><i class="fa fa-check"></i><b>7.7</b> Stap 7: Zet data in een SQL-database</a></li>
<li class="chapter" data-level="7.8" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-8-importeer-de-csv-bestanden-in-dbeaver"><i class="fa fa-check"></i><b>7.8</b> Stap 8: Importeer de CSV-bestanden in DBeaver</a></li>
<li class="chapter" data-level="7.9" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-9-inspecteer-de-tabellen-met-sql-queries"><i class="fa fa-check"></i><b>7.9</b> Stap 9: Inspecteer de tabellen met SQL queries</a></li>
<li class="chapter" data-level="7.10" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-8-voer-een-join-uit-met-sql"><i class="fa fa-check"></i><b>7.10</b> Stap 8: Voer een join uit met SQL</a></li>
<li class="chapter" data-level="7.11" data-path="structured-query-language.html"><a href="structured-query-language.html#stap-8-inlezen-en-visualiseren-in-r"><i class="fa fa-check"></i><b>7.11</b> Stap 8: Inlezen en visualiseren in R</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="structured-query-language.html"><a href="structured-query-language.html#a.-visualiseer-relatie-tussen-griep-en-levensverwachting"><i class="fa fa-check"></i><b>7.11.1</b> A. visualiseer relatie tussen griep en levensverwachting</a></li>
<li class="chapter" data-level="7.11.2" data-path="structured-query-language.html"><a href="structured-query-language.html#b.-lijngrafiek-over-tijd-per-land"><i class="fa fa-check"></i><b>7.11.2</b> B. Lijngrafiek over tijd per land</a></li>
<li class="chapter" data-level="7.11.3" data-path="structured-query-language.html"><a href="structured-query-language.html#c.-choropleth-map-wereldkaart"><i class="fa fa-check"></i><b>7.11.3</b> C. Choropleth map (wereldkaart)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>8</b> R package</a>
<ul>
<li class="chapter" data-level="8.1" data-path="r-package.html"><a href="r-package.html#documentatie-van-mijn-r-package-ministate"><i class="fa fa-check"></i><b>8.1</b> Documentatie van mijn R package: ministate</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="r-package.html"><a href="r-package.html#inleiding-1"><i class="fa fa-check"></i><b>8.1.1</b> Inleiding</a></li>
<li class="chapter" data-level="8.1.2" data-path="r-package.html"><a href="r-package.html#opzetten-van-het-project"><i class="fa fa-check"></i><b>8.1.2</b> 1. Opzetten van het project</a></li>
<li class="chapter" data-level="8.1.3" data-path="r-package.html"><a href="r-package.html#toevoegen-van-functies"><i class="fa fa-check"></i><b>8.1.3</b> 2. Toevoegen van functies</a></li>
<li class="chapter" data-level="8.1.4" data-path="r-package.html"><a href="r-package.html#testen-van-functies"><i class="fa fa-check"></i><b>8.1.4</b> 3. Testen van functies</a></li>
<li class="chapter" data-level="8.1.5" data-path="r-package.html"><a href="r-package.html#vignette-aanmaken"><i class="fa fa-check"></i><b>8.1.5</b> 4. Vignette aanmaken</a></li>
<li class="chapter" data-level="8.1.6" data-path="r-package.html"><a href="r-package.html#description-bestand"><i class="fa fa-check"></i><b>8.1.6</b> 5. DESCRIPTION bestand</a></li>
<li class="chapter" data-level="8.1.7" data-path="r-package.html"><a href="r-package.html#package-bouwen-en-checken"><i class="fa fa-check"></i><b>8.1.7</b> 6. Package bouwen en checken</a></li>
<li class="chapter" data-level="8.1.8" data-path="r-package.html"><a href="r-package.html#github-koppeling"><i class="fa fa-check"></i><b>8.1.8</b> 7. GitHub koppeling</a></li>
<li class="chapter" data-level="8.1.9" data-path="r-package.html"><a href="r-package.html#conclusie-2"><i class="fa fa-check"></i><b>8.1.9</b> Conclusie</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="r-package.html"><a href="r-package.html#voorbeeld-voor-het-gebruiken-van-de-package"><i class="fa fa-check"></i><b>8.2</b> Voorbeeld voor het gebruiken van de package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html"><i class="fa fa-check"></i><b>9</b> Geparameteriseerd COVID-19 Europa rapport</a>
<ul>
<li class="chapter" data-level="9.1" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#geparameteriseerd-data-verwerken"><i class="fa fa-check"></i><b>9.1</b> Geparameteriseerd data verwerken</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#stap-1-laad-de-benodigde-libraries"><i class="fa fa-check"></i><b>9.1.1</b> Stap 1: Laad de benodigde libraries</a></li>
<li class="chapter" data-level="9.1.2" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#stap-2-download-en-verwerk-de-data"><i class="fa fa-check"></i><b>9.1.2</b> Stap 2: Download en verwerk de data</a></li>
<li class="chapter" data-level="9.1.3" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#stap-3-foutafhandeling"><i class="fa fa-check"></i><b>9.1.3</b> Stap 3: Foutafhandeling</a></li>
<li class="chapter" data-level="9.1.4" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#stap-4-filter-de-data"><i class="fa fa-check"></i><b>9.1.4</b> Stap 4: Filter de data</a></li>
<li class="chapter" data-level="9.1.5" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#stap-5-het-analyseren-van-de-data"><i class="fa fa-check"></i><b>9.1.5</b> Stap 5: Het analyseren van de data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#interactieve-quiz-wat-weet-je-van-de-covid-data"><i class="fa fa-check"></i><b>9.2</b> 🧠 Interactieve Quiz: Wat weet je van de COVID-data?</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#vraag-1-hoeveel-dagen-zijn-er-met-gegevens-in-deze-selectie"><i class="fa fa-check"></i><b>9.2.1</b> Vraag 1: Hoeveel dagen zijn er met gegevens in deze selectie?</a></li>
<li class="chapter" data-level="9.2.2" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#vraag-2-hoeveel-besmettingen-zijn-er-in-totaal-gemeld"><i class="fa fa-check"></i><b>9.2.2</b> Vraag 2: Hoeveel besmettingen zijn er in totaal gemeld?</a></li>
<li class="chapter" data-level="9.2.3" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#vraag-3-wat-was-het-hoogste-aantal-besmettingen-op-één-dag"><i class="fa fa-check"></i><b>9.2.3</b> Vraag 3: Wat was het hoogste aantal besmettingen op één dag?</a></li>
<li class="chapter" data-level="9.2.4" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#vraag-4-hoe-ziet-het-verloop-van-besmettingen-eruit"><i class="fa fa-check"></i><b>9.2.4</b> Vraag 4: Hoe ziet het verloop van besmettingen eruit?</a></li>
<li class="chapter" data-level="9.2.5" data-path="geparameteriseerd-covid-19-europa-rapport.html"><a href="geparameteriseerd-covid-19-europa-rapport.html#vraag-5-hoe-ziet-het-verloop-van-sterfgevallen-eruit"><i class="fa fa-check"></i><b>9.2.5</b> Vraag 5: Hoe ziet het verloop van sterfgevallen eruit?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="project-introductie.html"><a href="project-introductie.html"><i class="fa fa-check"></i><b>10</b> Project introductie</a>
<ul>
<li class="chapter" data-level="10.1" data-path="project-introductie.html"><a href="project-introductie.html#minion-sequencing"><i class="fa fa-check"></i><b>10.1</b> minION sequencing</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="referenties.html"><a href="referenties.html"><i class="fa fa-check"></i><b>11</b> Referenties</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vooruikijken-massaspectrometrie" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Vooruikijken: Massaspectrometrie<a href="vooruikijken-massaspectrometrie.html#vooruikijken-massaspectrometrie" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Deze opdracht is onderdeel van de cursus <em>Workflows</em> en richt zich op het leren van een nieuwe <strong>Data Science for Biology</strong> skill: het analyseren van <strong>massaspectrometriedata in R</strong>. De keuze voor deze skill is gebaseerd op het toekomstbeeld waarin moleculair onderzoek gecombineerd wordt met bioinformatica.</p>
<hr />
<div id="toekomstbeeld-en-motivatie" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 1. Toekomstbeeld en motivatie<a href="vooruikijken-massaspectrometrie.html#toekomstbeeld-en-motivatie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Toekomstvisie</strong></p>
<p>Over een tot twee jaar mijn doel is om werkzaam te zijn in een onderzoeksomgeving zoals een academisch ziekenhuis, een universiteit of een biotechnologisch bedrijf. Het liefst in een rol waarin laboratoriumonderzoek wordt gecombineerd met bioinformatica, bijvoorbeeld op het gebied van eiwitonderzoek of medicijnontwikkeling.</p>
<p><strong>Huidige vaardigheden</strong></p>
<ul>
<li>Praktische ervaring met laboratoriumtechnieken zoals eiwitanalyse, sequencing, PCR</li>
<li>Data-analyse met R, GitHub en SQL</li>
<li>Basiskennis van bioinformatica en datavisualisatie</li>
</ul>
<p><strong>Nieuwe skill om te leren</strong></p>
<p>Om dichter bij het toekomstdoel te komen, wordt gekozen voor het leren analyseren van massaspectrometriedata. Deze analysetechniek is belangrijk in proteomics en wordt gebruikt voor eiwitidentificatie en -kwantificatie. Door dit te koppelen aan R wordt geleerd hoe ruwe data wordt omgezet naar bruikbare biologische informatie.</p>
<p><strong>Gekozen skill</strong>:<br />
<em>Analyseren van massaspectrometriedata in R</em></p>
<hr />
</div>
<div id="planning" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 2. Planning<a href="vooruikijken-massaspectrometrie.html#planning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="8%" />
<col width="41%" />
<col width="8%" />
<col width="40%" />
</colgroup>
<thead>
<tr class="header">
<th>Datum</th>
<th>Activiteit</th>
<th>Tijd (uren)</th>
<th>Toelichting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>05 mei</td>
<td>Introductie: wat is massaspectrometrie?</td>
<td>2</td>
<td>Begrijpen van het basisprincipe, zoeken van uitlegvideo’s</td>
</tr>
<tr class="even">
<td>06 mei</td>
<td>Wat kun je analyseren met massaspectrometrie?</td>
<td>2</td>
<td>Uitleg over toepassingen in eiwitonderzoek</td>
</tr>
<tr class="odd">
<td>07 mei</td>
<td>Installeren van R-packages (<code>MSnbase</code>, <code>Spectra</code>)</td>
<td>2</td>
<td>R en Bioconductor gereedmaken</td>
</tr>
<tr class="even">
<td>08 mei</td>
<td>Tutorial volgen: voorbeeldanalyse bekijken</td>
<td>3</td>
<td>Gebruik maken van online tutorials</td>
</tr>
<tr class="odd">
<td>09 mei</td>
<td>Begrippen oefenen: spectra, intensiteit, massa/charge</td>
<td>1</td>
<td>Leren herkennen in voorbeelddata</td>
</tr>
<tr class="even">
<td>10 mei</td>
<td>Voorbeelddataset downloaden (.mzML bestand)</td>
<td>2</td>
<td>Van PRIDE database of Bioconductor</td>
</tr>
<tr class="odd">
<td>11 mei</td>
<td>Data inlezen in R</td>
<td>2</td>
<td>Gebruik maken van <code>MSnbase::readMSData()</code></td>
</tr>
<tr class="even">
<td>12 mei</td>
<td>Eerste grafiek maken (bijv. chromatogram of spectrum)</td>
<td>3</td>
<td>Visualisatie oefenen met 1 sample</td>
</tr>
<tr class="odd">
<td>13 mei</td>
<td>Meer samples toevoegen, data filteren of normaliseren</td>
<td>3</td>
<td>Werken aan kwaliteit van de data</td>
</tr>
<tr class="even">
<td>14 mei</td>
<td>Eenvoudige analyse uitvoeren</td>
<td>3</td>
<td>Bijvoorbeeld gemiddelde intensiteit per sample vergelijken</td>
</tr>
<tr class="odd">
<td>15 mei</td>
<td>Resultaten visualiseren (boxplot, PCA of heatmap)</td>
<td>3</td>
<td>Overzicht maken van verschillen</td>
</tr>
<tr class="even">
<td>16 mei</td>
<td>Alles verwerken in RMarkdown</td>
<td>2</td>
<td>Duidelijk verslag maken van je leerproces</td>
</tr>
<tr class="odd">
<td>17 mei</td>
<td>Uploaden naar GitHub</td>
<td>2</td>
<td>Resultaat delen als bewijs</td>
</tr>
</tbody>
</table>
<p><strong>Totaal:</strong> 32 uur</p>
<hr />
</div>
<div id="inleiding" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 3. Inleiding<a href="vooruikijken-massaspectrometrie.html#inleiding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Massaspectrometrie is een krachtige techniek om moleculen zoals eiwitten te identificeren en kwantificeren op basis van hun massa en lading. In de proteomics wordt deze techniek veel gebruikt om eiwitprofielen van verschillende biologische condities te vergelijken, zoals zieke versus gezonde cellen.</p>
<p>In deze opdracht leer ik hoe ik massaspectrometriedata kan analyseren met R en Bioconductor. Het doel is om inzicht te krijgen in de structuur van deze data, deze correct te visualiseren, te normaliseren en een eenvoudige statistische analyse uit te voeren.</p>
<p><strong>Doel:</strong></p>
<p>Het verwerven van basisvaardigheden in het analyseren van massaspectrometriedata met R, met behulp van publieke data en Bioconductor-tools.</p>
<div class="float">
<img src="figs/Massa.png" alt="Figuur1: ILC mass spectrometers" />
<div class="figcaption">Figuur1: ILC mass spectrometers</div>
</div>
</div>
<div id="hoe-ziet-het-systeem-eruit" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 4. Hoe ziet het systeem eruit?<a href="vooruikijken-massaspectrometrie.html#hoe-ziet-het-systeem-eruit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Wat is een massaspectrometer?</strong></p>
<p>Een massaspectrometer is een analytisch instrument dat moleculen meet op basis van hun massa en lading. Het bestaat uit drie hoofdonderdelen:</p>
<hr />
<p><em>1. Inlaatsysteem (<em>Ionisatiebron</em>)</em></p>
<p>In dit onderdeel wordt het monster omgezet in geladen deeltjes (ionen). Afhankelijk van het type monster en toepassing worden verschillende ionisatiemethoden gebruikt:</p>
<ul>
<li><strong>Electrospray Ionization (ESI)</strong>: zacht en geschikt voor eiwitten en peptiden in oplossing.<br />
</li>
<li><strong>Matrix-Assisted Laser Desorption/Ionization (MALDI)</strong>: gebruikt voor grotere moleculen en vaste monsters.<br />
</li>
<li><strong>Electron Impact (EI)</strong>: vooral gebruikt voor kleinere, vluchtige moleculen, bijvoorbeeld in GC-MS.</li>
</ul>
<blockquote>
<p><em>Doel</em>: moleculen omzetten in ionen zodat ze kunnen worden gemeten.</p>
</blockquote>
<hr />
<p><em>2. Analyser (<em>Massascheider</em>)</em></p>
<p>De gevormde ionen worden gescheiden op basis van hun massa/lading-verhouding (m/z). Enkele veelgebruikte analyzers:</p>
<ul>
<li><strong>Time-of-Flight (TOF)</strong>: meet hoe snel ionen een afstand afleggen – lichtere ionen bewegen sneller.</li>
<li><strong>Quadrupole</strong>: gebruikt elektrische velden om specifieke m/z-waarden door te laten.</li>
<li><strong>Orbitrap / Ion Trap / FT-ICR</strong>: geavanceerde systemen met zeer hoge resolutie en nauwkeurigheid.</li>
</ul>
<blockquote>
<p><em>Doel</em>: scheiden van ionen op basis van m/z.</p>
</blockquote>
<hr />
<p><em>3. Detector</em></p>
<p>De gescheiden ionen worden opgevangen door een detector, die hun aantal en m/z meet. Zo ontstaat een massaspectrum: een grafiek met m/z op de x-as en intensiteit op de y-as.</p>
<blockquote>
<p><em>Doel</em>: meten van hoeveelheid ionen per m/z-waarde.</p>
</blockquote>
<div class="float">
<img src="figs/How_works_MS_1.png" alt="Figuur 2:Hoe werkt massaspectrometrie" />
<div class="figcaption">Figuur 2:Hoe werkt massaspectrometrie</div>
</div>
<div class="float">
<img src="figs/Componenten_en_typen_massaspectrometers.png" alt="Figuur 3: Componenten en typen massaspectrometers" />
<div class="figcaption">Figuur 3: Componenten en typen massaspectrometers</div>
</div>
<hr />
<p><strong>Wat kun je analyseren met massaspectrometrie?</strong></p>
<p>MS wordt breed ingezet in de biowetenschappen:</p>
<ul>
<li><strong>Identificatie</strong> van eiwitten in biologische samples</li>
<li><strong>Kwantificatie</strong> van eiwitniveaus (labelvrij of met labels)</li>
<li>Detectie van <strong>post-translationele modificaties</strong> (zoals fosforylatie)</li>
<li>Analyse van <strong>biomarkers</strong> bij ziekte</li>
</ul>
</div>
<div id="termen-in-de-massaspectrometrie" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Termen in de massaspectrometrie<a href="vooruikijken-massaspectrometrie.html#termen-in-de-massaspectrometrie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Belangrijke termen in de massaspectrometrie:</p>
<ul>
<li><strong>Spectrum</strong>: een grafiek met pieken die ionen representeren. De intensiteit tegenover massa/lading (m/z)</li>
<li><strong>Mass-to-charge ratio (m/z)</strong>: verhouding tussen massa en lading</li>
<li><strong>Intensiteit</strong>: hoogte van de piek – geeft hoeveelheid molecuul aan. In andere woorden hoe sterk het signaal is van een ion. De eenheid hiervan is meestal arbitrair en wordt vaak gewoon “intensiteit” genoemd. Het is een relatieve waarde die aangeeft hoe sterk het signaal is van de ionen, maar het is géén absolute concentratie in mol/liter of zo.</li>
<li><strong>Retention time</strong>: moment waarop het molecuul het systeem verlaat. In andere woorden tijd waarop een molecuul wordt gedetecteerd. Meestal uitgedrukt in seconden (s) of minuten (min).</li>
</ul>
<p><strong>Voorbeeld van een chromatogram in R</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="vooruikijken-massaspectrometrie.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(MSnbase)</span>
<span id="cb1-2"><a href="vooruikijken-massaspectrometrie.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="vooruikijken-massaspectrometrie.html#cb1-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="st">&quot;sciex&quot;</span>, <span class="at">package =</span> <span class="st">&quot;msdata&quot;</span>), <span class="at">full.names =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]</span>
<span id="cb1-4"><a href="vooruikijken-massaspectrometrie.html#cb1-4" tabindex="-1"></a>ms_data <span class="ot">&lt;-</span> <span class="fu">readMSData</span>(f, <span class="at">mode =</span> <span class="st">&quot;onDisk&quot;</span>)</span>
<span id="cb1-5"><a href="vooruikijken-massaspectrometrie.html#cb1-5" tabindex="-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(ms_data)</span>
<span id="cb1-6"><a href="vooruikijken-massaspectrometrie.html#cb1-6" tabindex="-1"></a><span class="fu">plot</span>(chrom[<span class="dv">1</span>, <span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/plot-chromatogram-1.png" width="672" /></p>
<p><em>Figuur 4: Een voorbeeld van een chromatorgram in R. Op de y-as is de Intensiteit arbitraire eenheden (relatieve ionenintensiteit) en op de x-as is de retention time in seconden (s) te zien</em></p>
</div>
<div id="tools-en-packages" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Tools en packages<a href="vooruikijken-massaspectrometrie.html#tools-en-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Voor het analyseren van massaspectrometriedata in R zijn de volgende Bioconductor-packages nodig:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="vooruikijken-massaspectrometrie.html#cb2-1" tabindex="-1"></a><span class="co"># Installatie van benodigde packages</span></span>
<span id="cb2-2"><a href="vooruikijken-massaspectrometrie.html#cb2-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb2-3"><a href="vooruikijken-massaspectrometrie.html#cb2-3" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb2-4"><a href="vooruikijken-massaspectrometrie.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="vooruikijken-massaspectrometrie.html#cb2-5" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="fu">c</span>(<span class="st">&quot;MSnbase&quot;</span>, <span class="st">&quot;Spectra&quot;</span>, <span class="st">&quot;pheatmap&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;FactoMineR&quot;</span>, <span class="st">&quot;factoextra&quot;</span>, <span class="st">&quot;Rtsne&quot;</span>))</span></code></pre></div>
<p>We gebruiken de volgende R-packages:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="vooruikijken-massaspectrometrie.html#cb3-1" tabindex="-1"></a><span class="co"># Laad de libraries die je nodig hebt voor de analyse.</span></span>
<span id="cb3-2"><a href="vooruikijken-massaspectrometrie.html#cb3-2" tabindex="-1"></a><span class="fu">library</span>(MSnbase)       <span class="co"># Massaspectrometrie analyse</span></span>
<span id="cb3-3"><a href="vooruikijken-massaspectrometrie.html#cb3-3" tabindex="-1"></a><span class="fu">library</span>(Spectra)       <span class="co"># Spectrum verwerking</span></span>
<span id="cb3-4"><a href="vooruikijken-massaspectrometrie.html#cb3-4" tabindex="-1"></a><span class="fu">library</span>(msdata)        <span class="co"># Voorbeelddata voor massaspectrometrie</span></span>
<span id="cb3-5"><a href="vooruikijken-massaspectrometrie.html#cb3-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)       <span class="co"># Grafieken maken</span></span>
<span id="cb3-6"><a href="vooruikijken-massaspectrometrie.html#cb3-6" tabindex="-1"></a><span class="fu">library</span>(pheatmap)      <span class="co"># Heatmaps</span></span>
<span id="cb3-7"><a href="vooruikijken-massaspectrometrie.html#cb3-7" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)    <span class="co"># PCA-analyse</span></span>
<span id="cb3-8"><a href="vooruikijken-massaspectrometrie.html#cb3-8" tabindex="-1"></a><span class="fu">library</span>(factoextra)    <span class="co"># Visualisatie PCA</span></span>
<span id="cb3-9"><a href="vooruikijken-massaspectrometrie.html#cb3-9" tabindex="-1"></a><span class="fu">library</span>(Rtsne)         <span class="co"># t-SNE analyse</span></span>
<span id="cb3-10"><a href="vooruikijken-massaspectrometrie.html#cb3-10" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-11"><a href="vooruikijken-massaspectrometrie.html#cb3-11" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
</div>
<div id="uitwerking-met-msdata" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> 4. Uitwerking met msdata<a href="vooruikijken-massaspectrometrie.html#uitwerking-met-msdata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introductie-bestandsformaat-en-voorbeelddata" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Introductie bestandsformaat en voorbeelddata<a href="vooruikijken-massaspectrometrie.html#introductie-bestandsformaat-en-voorbeelddata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Voor deze opdracht gebruik ik een voorbeeldbestand uit het msdata-pakket van Bioconductor. Dit bestand heeft het .mzML-formaat, een open standaard voor massaspectrometrie (MS) data.</p>
<p>Het .mzML-formaat is gebaseerd op XML en is gemaakt om ruwe MS-data goed en overzichtelijk op te slaan. Het werkt op verschillende computers en programma’s. In één bestand kunnen meerdere spectra zitten, bijvoorbeeld van verschillende MS-niveaus (zoals MS1 en MS2). Hierdoor kan ik ook ingewikkelde MS-experimenten analyseren, zoals experimenten met fragmentatie (MS/MS).</p>
</div>
<div id="hoe-ik-de-data-inlees" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Hoe ik de data inlees<a href="vooruikijken-massaspectrometrie.html#hoe-ik-de-data-inlees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ik lees het voorbeeldbestand in met het readMSData-commando uit het MSnbase-pakket. Hierbij gebruik ik de optie onDisk, zodat ik niet alles tegelijk in het geheugen hoef te laden. Dit is handig, want MS-bestanden zijn vaak heel groot.</p>
<p>Daarna bekijk ik een korte samenvatting van de data, zoals het aantal spectra, welke MS-niveaus aanwezig zijn, en de retentietijden (hoe lang het monster in de machine zat).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="vooruikijken-massaspectrometrie.html#cb4-1" tabindex="-1"></a><span class="co"># Het inlezen van een voorbeeld .mzML bestand uit het msdata-pakket.</span></span>
<span id="cb4-2"><a href="vooruikijken-massaspectrometrie.html#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="vooruikijken-massaspectrometrie.html#cb4-3" tabindex="-1"></a><span class="co"># Dit bestand bevat massaspectrometrie data in een open formaat.</span></span>
<span id="cb4-4"><a href="vooruikijken-massaspectrometrie.html#cb4-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">dir</span>(<span class="fu">system.file</span>(<span class="st">&quot;sciex&quot;</span>, <span class="at">package =</span> <span class="st">&quot;msdata&quot;</span>), <span class="at">full.names =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]</span>
<span id="cb4-5"><a href="vooruikijken-massaspectrometrie.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="vooruikijken-massaspectrometrie.html#cb4-6" tabindex="-1"></a><span class="co"># Lees het bestand in als OnDiskMSnExp object, dat efficiënt met grote data kan omgaan.</span></span>
<span id="cb4-7"><a href="vooruikijken-massaspectrometrie.html#cb4-7" tabindex="-1"></a>ms_data <span class="ot">&lt;-</span> <span class="fu">readMSData</span>(f, <span class="at">mode =</span> <span class="st">&quot;onDisk&quot;</span>)</span>
<span id="cb4-8"><a href="vooruikijken-massaspectrometrie.html#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="vooruikijken-massaspectrometrie.html#cb4-9" tabindex="-1"></a><span class="co"># Toon een samenvatting van de data (aantal spectra, MS-levels, etc.)</span></span>
<span id="cb4-10"><a href="vooruikijken-massaspectrometrie.html#cb4-10" tabindex="-1"></a>ms_data</span></code></pre></div>
<pre><code>## MSn experiment data (&quot;OnDiskMSnExp&quot;)
## Object size in memory: 0.36 Mb
## - - - Spectra data - - -
##  MS level(s): 1 
##  Number of spectra: 931 
##  MSn retention times: 0:00 - 4:20 minutes
## - - - Processing information - - -
## Data loaded [Sun May 25 22:15:49 2025] 
##  MSnbase version: 2.32.0 
## - - - Meta data  - - -
## phenoData
##   rowNames: 20171016_POOL_POS_1_105-134.mzML
##   varLabels: sampleNames
##   varMetadata: labelDescription
## Loaded from:
##   20171016_POOL_POS_1_105-134.mzML 
## protocolData: none
## featureData
##   featureNames: F1.S001 F1.S002 ... F1.S931 (931 total)
##   fvarLabels: fileIdx spIdx ... spectrum (35 total)
##   fvarMetadata: labelDescription
## experimentData: use &#39;experimentData(object)&#39;</code></pre>
<hr />
</div>
<div id="verkennen-van-spectra" class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> Verkennen van spectra<a href="vooruikijken-massaspectrometrie.html#verkennen-van-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Een veelgebruikte grafiek in massaspectrometrie is het chromatogram, bijvoorbeeld het Total Ion Chromatogram (TIC). Dit laat zien hoeveel ionen er per tijdspunt zijn gedetecteerd. Zo kan ik makkelijk zien waar pieken en mogelijke verstoringen zitten.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="vooruikijken-massaspectrometrie.html#cb6-1" tabindex="-1"></a><span class="co"># Check hoeveel spectra er in het bestand zitten.</span></span>
<span id="cb6-2"><a href="vooruikijken-massaspectrometrie.html#cb6-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Aantal spectra totaal:&quot;</span>, <span class="fu">length</span>(ms_data), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Aantal spectra totaal: 931</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="vooruikijken-massaspectrometrie.html#cb8-1" tabindex="-1"></a><span class="co"># Bekijk de verdeling van MS-niveaus (bijv. MS1, MS2)</span></span>
<span id="cb8-2"><a href="vooruikijken-massaspectrometrie.html#cb8-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="fu">msLevel</span>(ms_data)))</span></code></pre></div>
<pre><code>## 
##   1 
## 931</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="vooruikijken-massaspectrometrie.html#cb10-1" tabindex="-1"></a><span class="co"># Bekijk het bereik van retentietijden (hoe lang duurde de meting)</span></span>
<span id="cb10-2"><a href="vooruikijken-massaspectrometrie.html#cb10-2" tabindex="-1"></a>rt_range <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">rtime</span>(ms_data))</span>
<span id="cb10-3"><a href="vooruikijken-massaspectrometrie.html#cb10-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Retentietijd range:&quot;</span>, rt_range[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>, rt_range[<span class="dv">2</span>], <span class="st">&quot;seconden</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Retentietijd range: 0.28 - 259.757 seconden</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="vooruikijken-massaspectrometrie.html#cb12-1" tabindex="-1"></a><span class="co"># Optioneel: histogram van retentietijden voor visuele inspectie</span></span>
<span id="cb12-2"><a href="vooruikijken-massaspectrometrie.html#cb12-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rtime</span>(ms_data), <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;Histogram van retentietijden&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Retentietijd (s)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/explore-ms-1.png" width="672" /></p>
<p><em>Figuur 5: Een histogram van de retentietijden. Op de y-as is de frequency en op de x-as is de retentietijd in seconden (s) te zien</em></p>
<hr />
</div>
<div id="plotten-van-chromatogram" class="section level3 hasAnchor" number="3.7.4">
<h3><span class="header-section-number">3.7.4</span> Plotten van chromatogram<a href="vooruikijken-massaspectrometrie.html#plotten-van-chromatogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Met <code>chromatogram()</code> maak ik een Total Ion Chromatogram (TIC):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="vooruikijken-massaspectrometrie.html#cb13-1" tabindex="-1"></a><span class="co"># Maak een chromatogram aan, wat de totale ionenintensiteit over retentietijd weergeeft.</span></span>
<span id="cb13-2"><a href="vooruikijken-massaspectrometrie.html#cb13-2" tabindex="-1"></a>chrom <span class="ot">&lt;-</span> <span class="fu">chromatogram</span>(ms_data)</span>
<span id="cb13-3"><a href="vooruikijken-massaspectrometrie.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="vooruikijken-massaspectrometrie.html#cb13-4" tabindex="-1"></a><span class="co"># Plot het eerste chromatogram (Total Ion Chromatogram)</span></span>
<span id="cb13-5"><a href="vooruikijken-massaspectrometrie.html#cb13-5" tabindex="-1"></a><span class="fu">plot</span>(chrom[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Total Ion Chromatogram (TIC)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/plot-chrom-1.png" width="672" /></p>
<p><em>Figuur 6: Een chromatorgram. Op de y-as is de Intensiteit arbitraire eenheden (relatieve ionenintensiteit) en op de x-as is de retention time in seconden (s) te zien</em></p>
<p>Het chromatogram geeft een overzicht van de totale intensiteit van ionen gedurende de looptijd van de meting. Dit kan pieken en afwijkingen laten zien.</p>
<hr />
</div>
<div id="filteren-op-retentietijd-en-ms-level" class="section level3 hasAnchor" number="3.7.5">
<h3><span class="header-section-number">3.7.5</span> Filteren op retentietijd en MS-level<a href="vooruikijken-massaspectrometrie.html#filteren-op-retentietijd-en-ms-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vaak wil ik alleen de relevante data gebruiken. Daarom filter ik spectra op een bepaald retentietijd-interval en kies ik bijvoorbeeld alleen de MS1 spectra (de ‘precursor’ scans). Dit maakt de dataset kleiner en overzichtelijker, wat handig is voor verdere analyse.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="vooruikijken-massaspectrometrie.html#cb14-1" tabindex="-1"></a><span class="co"># Filter de spectra op een relevant retentietijd-interval, bijvoorbeeld het middenstuk van de run.</span></span>
<span id="cb14-2"><a href="vooruikijken-massaspectrometrie.html#cb14-2" tabindex="-1"></a>rt_filter <span class="ot">&lt;-</span> <span class="fu">c</span>(rt_range[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">10</span>, rt_range[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">10</span>)</span>
<span id="cb14-3"><a href="vooruikijken-massaspectrometrie.html#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="vooruikijken-massaspectrometrie.html#cb14-4" tabindex="-1"></a>ms_data_filtered <span class="ot">&lt;-</span> <span class="fu">filterRt</span>(ms_data, <span class="at">rt =</span> rt_filter)</span>
<span id="cb14-5"><a href="vooruikijken-massaspectrometrie.html#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="vooruikijken-massaspectrometrie.html#cb14-6" tabindex="-1"></a><span class="co"># Beperk tot MS1 spectra (eerste niveau massaspectrometrie)</span></span>
<span id="cb14-7"><a href="vooruikijken-massaspectrometrie.html#cb14-7" tabindex="-1"></a>ms_data_filtered <span class="ot">&lt;-</span> <span class="fu">filterMsLevel</span>(ms_data_filtered, <span class="at">msLevel =</span> <span class="dv">1</span>)</span>
<span id="cb14-8"><a href="vooruikijken-massaspectrometrie.html#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="vooruikijken-massaspectrometrie.html#cb14-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Aantal spectra na filteren:&quot;</span>, <span class="fu">length</span>(ms_data_filtered), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Aantal spectra na filteren: 859</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="vooruikijken-massaspectrometrie.html#cb16-1" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(ms_data_filtered) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;Geen spectra gevonden na filteren! Pas je RT interval aan.&quot;</span>)</span></code></pre></div>
<hr />
</div>
<div id="gemiddeld-spectrum-handmatig-berekenen-en-plotten" class="section level3 hasAnchor" number="3.7.6">
<h3><span class="header-section-number">3.7.6</span> Gemiddeld spectrum handmatig berekenen en plotten<a href="vooruikijken-massaspectrometrie.html#gemiddeld-spectrum-handmatig-berekenen-en-plotten" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Door meerdere spectra samen te voegen kan ik een gemiddeld spectrum maken. Dit helpt om ruis te verminderen en algemene pieken beter te herkennen.</p>
<p>Ik pak alle spectra, zet de m/z-waarden om naar een gemeenschappelijk raster, interpolateer de intensiteiten en bereken het gemiddelde per m/z-waarde. Daarna plot ik het gemiddelde spectrum.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="vooruikijken-massaspectrometrie.html#cb17-1" tabindex="-1"></a><span class="co"># Haal individuele spectra op uit het gefilterde object</span></span>
<span id="cb17-2"><a href="vooruikijken-massaspectrometrie.html#cb17-2" tabindex="-1"></a>spectra_list <span class="ot">&lt;-</span> <span class="fu">spectra</span>(ms_data_filtered)</span>
<span id="cb17-3"><a href="vooruikijken-massaspectrometrie.html#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="vooruikijken-massaspectrometrie.html#cb17-4" tabindex="-1"></a><span class="co"># Pak m/z waarden en intensiteiten per spectrum</span></span>
<span id="cb17-5"><a href="vooruikijken-massaspectrometrie.html#cb17-5" tabindex="-1"></a>mz_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(spectra_list, mz)</span>
<span id="cb17-6"><a href="vooruikijken-massaspectrometrie.html#cb17-6" tabindex="-1"></a>int_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(spectra_list, intensity)</span>
<span id="cb17-7"><a href="vooruikijken-massaspectrometrie.html#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="vooruikijken-massaspectrometrie.html#cb17-8" tabindex="-1"></a><span class="co"># Combineer alle m/z waarden voor een gemeenschappelijk raster</span></span>
<span id="cb17-9"><a href="vooruikijken-massaspectrometrie.html#cb17-9" tabindex="-1"></a>mz_vals_all <span class="ot">&lt;-</span> <span class="fu">unlist</span>(mz_list)</span>
<span id="cb17-10"><a href="vooruikijken-massaspectrometrie.html#cb17-10" tabindex="-1"></a>mz_vals_all <span class="ot">&lt;-</span> mz_vals_all[<span class="fu">is.finite</span>(mz_vals_all)]</span>
<span id="cb17-11"><a href="vooruikijken-massaspectrometrie.html#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="vooruikijken-massaspectrometrie.html#cb17-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">length</span>(mz_vals_all) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;Geen valide m/z waarden gevonden!&quot;</span>)</span>
<span id="cb17-13"><a href="vooruikijken-massaspectrometrie.html#cb17-13" tabindex="-1"></a></span>
<span id="cb17-14"><a href="vooruikijken-massaspectrometrie.html#cb17-14" tabindex="-1"></a><span class="co"># Definieer gemeenschappelijk m/z raster met stapgrootte 0.1</span></span>
<span id="cb17-15"><a href="vooruikijken-massaspectrometrie.html#cb17-15" tabindex="-1"></a>common_mz <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(mz_vals_all), <span class="at">to =</span> <span class="fu">max</span>(mz_vals_all), <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb17-16"><a href="vooruikijken-massaspectrometrie.html#cb17-16" tabindex="-1"></a></span>
<span id="cb17-17"><a href="vooruikijken-massaspectrometrie.html#cb17-17" tabindex="-1"></a><span class="co"># Functie om intensiteiten te interpoleren naar het gemeenschappelijke raster</span></span>
<span id="cb17-18"><a href="vooruikijken-massaspectrometrie.html#cb17-18" tabindex="-1"></a>interp_intensity <span class="ot">&lt;-</span> <span class="cf">function</span>(mz_vals, intensities, common_mz) {</span>
<span id="cb17-19"><a href="vooruikijken-massaspectrometrie.html#cb17-19" tabindex="-1"></a>  <span class="fu">approx</span>(mz_vals, intensities, <span class="at">xout =</span> common_mz, <span class="at">yleft =</span> <span class="dv">0</span>, <span class="at">yright =</span> <span class="dv">0</span>)<span class="sc">$</span>y</span>
<span id="cb17-20"><a href="vooruikijken-massaspectrometrie.html#cb17-20" tabindex="-1"></a>}</span>
<span id="cb17-21"><a href="vooruikijken-massaspectrometrie.html#cb17-21" tabindex="-1"></a></span>
<span id="cb17-22"><a href="vooruikijken-massaspectrometrie.html#cb17-22" tabindex="-1"></a><span class="co"># Interpoleer alle spectra naar hetzelfde m/z raster</span></span>
<span id="cb17-23"><a href="vooruikijken-massaspectrometrie.html#cb17-23" tabindex="-1"></a>interp_intensities <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">seq_along</span>(mz_list), <span class="cf">function</span>(i) {</span>
<span id="cb17-24"><a href="vooruikijken-massaspectrometrie.html#cb17-24" tabindex="-1"></a>  <span class="fu">interp_intensity</span>(mz_list[[i]], int_list[[i]], common_mz)</span>
<span id="cb17-25"><a href="vooruikijken-massaspectrometrie.html#cb17-25" tabindex="-1"></a>})</span>
<span id="cb17-26"><a href="vooruikijken-massaspectrometrie.html#cb17-26" tabindex="-1"></a></span>
<span id="cb17-27"><a href="vooruikijken-massaspectrometrie.html#cb17-27" tabindex="-1"></a><span class="co"># Bereken het gemiddelde spectrum</span></span>
<span id="cb17-28"><a href="vooruikijken-massaspectrometrie.html#cb17-28" tabindex="-1"></a>mean_intensity <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(interp_intensities)</span>
<span id="cb17-29"><a href="vooruikijken-massaspectrometrie.html#cb17-29" tabindex="-1"></a></span>
<span id="cb17-30"><a href="vooruikijken-massaspectrometrie.html#cb17-30" tabindex="-1"></a><span class="co"># Plot het gemiddelde spectrum</span></span>
<span id="cb17-31"><a href="vooruikijken-massaspectrometrie.html#cb17-31" tabindex="-1"></a><span class="fu">plot</span>(common_mz, mean_intensity, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb17-32"><a href="vooruikijken-massaspectrometrie.html#cb17-32" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;m/z&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Gemiddelde intensiteit&quot;</span>,</span>
<span id="cb17-33"><a href="vooruikijken-massaspectrometrie.html#cb17-33" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gemiddeld spectrum (handmatig berekend)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/mean-spectrum-1.png" width="672" /></p>
<p><em>Figuur 7: Een gemiddeld spectrum (handmatig berekend). Op de y-as is de gemiddelde Intensiteit arbitraire eenheden (relatieve ionenintensiteit) en op de x-as is de Mass-to-charge ratio (m/z) te zien</em></p>
<hr />
</div>
<div id="pca-op-voorbeelddata" class="section level3 hasAnchor" number="3.7.7">
<h3><span class="header-section-number">3.7.7</span> PCA op voorbeelddata<a href="vooruikijken-massaspectrometrie.html#pca-op-voorbeelddata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Met Principal Component Analysis (PCA) kan ik patronen en verschillen tussen spectra ontdekken. PCA maakt ingewikkelde data eenvoudiger door ze samen te vatten in een paar belangrijke componenten.</p>
<p>Ik gebruik een deel van de spectra om PCA uit te voeren en plot het resultaat. Zo kan ik zien welke spectra op elkaar lijken en welke verschillen, wat kan wijzen op verschillende monsters of condities.</p>
<p>PCA helpt mij om de complexiteit van de data te verminderen en te zien of spectra in groepen clusteren of juist veel variatie laten zien.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="vooruikijken-massaspectrometrie.html#cb18-1" tabindex="-1"></a><span class="co"># Gebruik een subset van spectra (maximaal 50) voor PCA vanwege rekentijd</span></span>
<span id="cb18-2"><a href="vooruikijken-massaspectrometrie.html#cb18-2" tabindex="-1"></a>n_pca <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">50</span>, <span class="fu">length</span>(ms_data_filtered))</span>
<span id="cb18-3"><a href="vooruikijken-massaspectrometrie.html#cb18-3" tabindex="-1"></a>intensity_mat <span class="ot">&lt;-</span> interp_intensities[, <span class="dv">1</span><span class="sc">:</span>n_pca]</span>
<span id="cb18-4"><a href="vooruikijken-massaspectrometrie.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="vooruikijken-massaspectrometrie.html#cb18-5" tabindex="-1"></a><span class="co"># Transponeer zodat spectra rijen zijn en m/z kolommen</span></span>
<span id="cb18-6"><a href="vooruikijken-massaspectrometrie.html#cb18-6" tabindex="-1"></a>intensity_mat_t <span class="ot">&lt;-</span> <span class="fu">t</span>(intensity_mat)</span>
<span id="cb18-7"><a href="vooruikijken-massaspectrometrie.html#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="vooruikijken-massaspectrometrie.html#cb18-8" tabindex="-1"></a><span class="co"># Voer PCA uit om patronen en clustering te vinden</span></span>
<span id="cb18-9"><a href="vooruikijken-massaspectrometrie.html#cb18-9" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">PCA</span>(intensity_mat_t, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-10"><a href="vooruikijken-massaspectrometrie.html#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="vooruikijken-massaspectrometrie.html#cb18-11" tabindex="-1"></a><span class="co"># Visualiseer PCA-resultaten</span></span>
<span id="cb18-12"><a href="vooruikijken-massaspectrometrie.html#cb18-12" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_res, <span class="at">title =</span> <span class="st">&quot;PCA van massaspectrometriedata&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/pca%20plot-1.png" width="672" /></p>
<p><em>Figuur 8: PCA-plot waarin spectra worden weergegeven op basis van de belangrijkste variaties in de data. De assen tonen de eerste twee principal components, die samenvattingen zijn van de verschillen tussen spectra.</em></p>
<p>Deze PCA-plot toont de eerste twee hoofdcomponenten van de massaspectrometriedata, die samen 8% van de totale variatie verklaren. Elk punt vertegenwoordigt een spectrum; spectra die dicht bij elkaar liggen, vertonen gelijkaardige signaalpatronen, terwijl uitbijters (zoals punt 6 en 30) mogelijk afwijkende profielen hebben. De lage verklaarde variantie wijst op complexe data met veel dimensies. Deze visualisatie geeft een eerste indruk van gelijkenissen en verschillen tussen spectra.</p>
<hr />
</div>
<div id="t-sne-visualisatie-van-spectra" class="section level3 hasAnchor" number="3.7.8">
<h3><span class="header-section-number">3.7.8</span> t-SNE visualisatie van spectra<a href="vooruikijken-massaspectrometrie.html#t-sne-visualisatie-van-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Waar PCA lineaire verbanden tussen spectra onderzoekt, is t-distributed Stochastic Neighbor Embedding (t-SNE) een niet-lineaire methode die speciaal geschikt is om lokale structuur en clusters in hoge-dimensionale data zichtbaar te maken. t-SNE reduceert de data tot twee dimensies, zodat ik de verschillen tussen spectra kan visualiseren in een scatterplot.</p>
<p>Dit helpt mij om bijvoorbeeld subtiele verschillen tussen spectra op te sporen die in PCA minder duidelijk zichtbaar zijn.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="vooruikijken-massaspectrometrie.html#cb19-1" tabindex="-1"></a><span class="co"># t-SNE vereist volledige data zonder ontbrekende waarden</span></span>
<span id="cb19-2"><a href="vooruikijken-massaspectrometrie.html#cb19-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.finite</span>(intensity_mat_t))) {</span>
<span id="cb19-3"><a href="vooruikijken-massaspectrometrie.html#cb19-3" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;Niet alle waarden zijn eindig. Vervang NA/Inf met 0 voor t-SNE.&quot;</span>)</span>
<span id="cb19-4"><a href="vooruikijken-massaspectrometrie.html#cb19-4" tabindex="-1"></a>  intensity_mat_t[<span class="sc">!</span><span class="fu">is.finite</span>(intensity_mat_t)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb19-5"><a href="vooruikijken-massaspectrometrie.html#cb19-5" tabindex="-1"></a>}</span>
<span id="cb19-6"><a href="vooruikijken-massaspectrometrie.html#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="vooruikijken-massaspectrometrie.html#cb19-7" tabindex="-1"></a><span class="co"># t-SNE analyse uitvoeren (dit kan enige tijd duren)</span></span>
<span id="cb19-8"><a href="vooruikijken-massaspectrometrie.html#cb19-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Voor reproduceerbaarheid</span></span>
<span id="cb19-9"><a href="vooruikijken-massaspectrometrie.html#cb19-9" tabindex="-1"></a>tsne_res <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(intensity_mat_t, <span class="at">dims =</span> <span class="dv">2</span>, <span class="at">perplexity =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Performing PCA
## Read the 50 x 50 data matrix successfully!
## OpenMP is working. 1 threads.
## Using no_dims = 2, perplexity = 10.000000, and theta = 0.500000
## Computing input similarities...
## Building tree...
## Done in 0.00 seconds (sparsity = 0.737600)!
## Learning embedding...
## Iteration 50: error is 54.405711 (50 iterations in 0.00 seconds)
## Iteration 100: error is 57.432260 (50 iterations in 0.00 seconds)
## Iteration 150: error is 55.561156 (50 iterations in 0.00 seconds)
## Iteration 200: error is 60.018003 (50 iterations in 0.00 seconds)
## Iteration 250: error is 58.704198 (50 iterations in 0.00 seconds)
## Iteration 300: error is 1.880032 (50 iterations in 0.00 seconds)
## Iteration 350: error is 1.471422 (50 iterations in 0.00 seconds)
## Iteration 400: error is 0.885947 (50 iterations in 0.00 seconds)
## Iteration 450: error is 0.818365 (50 iterations in 0.00 seconds)
## Iteration 500: error is 0.646077 (50 iterations in 0.00 seconds)
## Iteration 550: error is 0.450060 (50 iterations in 0.00 seconds)
## Iteration 600: error is 0.428152 (50 iterations in 0.00 seconds)
## Iteration 650: error is 0.426304 (50 iterations in 0.00 seconds)
## Iteration 700: error is 0.425267 (50 iterations in 0.00 seconds)
## Iteration 750: error is 0.423981 (50 iterations in 0.00 seconds)
## Iteration 800: error is 0.422391 (50 iterations in 0.00 seconds)
## Iteration 850: error is 0.420444 (50 iterations in 0.00 seconds)
## Iteration 900: error is 0.424439 (50 iterations in 0.00 seconds)
## Iteration 950: error is 0.424924 (50 iterations in 0.00 seconds)
## Iteration 1000: error is 0.408937 (50 iterations in 0.00 seconds)
## Fitting performed in 0.03 seconds.</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="vooruikijken-massaspectrometrie.html#cb21-1" tabindex="-1"></a><span class="co"># Resultaten in een dataframe voor ggplot</span></span>
<span id="cb21-2"><a href="vooruikijken-massaspectrometrie.html#cb21-2" tabindex="-1"></a>tsne_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-3"><a href="vooruikijken-massaspectrometrie.html#cb21-3" tabindex="-1"></a>  <span class="at">Dim1 =</span> tsne_res<span class="sc">$</span>Y[,<span class="dv">1</span>],</span>
<span id="cb21-4"><a href="vooruikijken-massaspectrometrie.html#cb21-4" tabindex="-1"></a>  <span class="at">Dim2 =</span> tsne_res<span class="sc">$</span>Y[,<span class="dv">2</span>],</span>
<span id="cb21-5"><a href="vooruikijken-massaspectrometrie.html#cb21-5" tabindex="-1"></a>  <span class="at">Spectrum =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tsne_res<span class="sc">$</span>Y))</span>
<span id="cb21-6"><a href="vooruikijken-massaspectrometrie.html#cb21-6" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="vooruikijken-massaspectrometrie.html#cb21-7" tabindex="-1"></a></span>
<span id="cb21-8"><a href="vooruikijken-massaspectrometrie.html#cb21-8" tabindex="-1"></a><span class="co"># Plot met ggplot2</span></span>
<span id="cb21-9"><a href="vooruikijken-massaspectrometrie.html#cb21-9" tabindex="-1"></a><span class="fu">ggplot</span>(tsne_df, <span class="fu">aes</span>(<span class="at">x =</span> Dim1, <span class="at">y =</span> Dim2)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="vooruikijken-massaspectrometrie.html#cb21-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="vooruikijken-massaspectrometrie.html#cb21-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="vooruikijken-massaspectrometrie.html#cb21-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;t-SNE visualisatie van spectra&quot;</span>,</span>
<span id="cb21-13"><a href="vooruikijken-massaspectrometrie.html#cb21-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;t-SNE Dimensie 1&quot;</span>,</span>
<span id="cb21-14"><a href="vooruikijken-massaspectrometrie.html#cb21-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;t-SNE Dimensie 2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/t-SNE-1.png" width="672" /></p>
<p><em>Figuur 9: t-SNE-plot van de spectrale data. Elk punt stelt een spectrum voor. Nabijheid in de plot suggereert gelijkaardige piekpatronen. De methode is gevoelig voor lokale structuren in de data.</em></p>
<p>Deze t-SNE plot laat zien hoe massaspectra zich groeperen. Ik zie duidelijke clusters: spectra die chemisch op elkaar lijken, liggen dicht bij elkaar. De lege ruimtes tussen clusters tonen duidelijke verschillen tussen groepen. Compacte clusters betekenen sterke overeenkomsten, verspreide punten zijn mogelijk uitschieters. Deze visualisatie helpt me snel patronen en relaties te herkennen.</p>
<hr />
</div>
</div>
<div id="uitwerking-met-de-prolocdata" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> 5. Uitwerking met de pRolocdata<a href="vooruikijken-massaspectrometrie.html#uitwerking-met-de-prolocdata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In deze analyse gebruik ik massaspectrometriegegevens uit de <code>dunkley2006</code> dataset, die beschikbaar is via het <code>pRolocdata</code>-pakket. Deze dataset bevat kwantitatieve gegevens over eiwitten in plantencellen en hun lokalisatie in verschillende subcellulaire compartimenten. Met behulp van <strong>PCA</strong>, <strong>t-SNE</strong> en <strong>machine learning (SVM)</strong> onderzoek ik hoe goed eiwitten op basis van deze data geclassificeerd kunnen worden naar hun locatie in de cel.</p>
<hr />
<div id="stap-1-installatie-en-laden-van-benodigde-pakketten" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Stap 1: Installatie en laden van benodigde pakketten<a href="vooruikijken-massaspectrometrie.html#stap-1-installatie-en-laden-van-benodigde-pakketten" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Voor deze analyse heb ik de volgende R/Bioconductor-pakketten nodig:</p>
<ul>
<li><code>pRoloc</code> en <code>pRolocdata</code>: voor data en analyse van eiwitlokalisatie.</li>
<li><code>Rtsne</code>: om t-SNE plots te maken.</li>
<li><code>pheatmap</code>: om expressiedata te visualiseren in een heatmap.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="vooruikijken-massaspectrometrie.html#cb22-1" tabindex="-1"></a><span class="co"># Installeer Bioconductor-pakketten als ze nog niet aanwezig zijn</span></span>
<span id="cb22-2"><a href="vooruikijken-massaspectrometrie.html#cb22-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-3"><a href="vooruikijken-massaspectrometrie.html#cb22-3" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb22-4"><a href="vooruikijken-massaspectrometrie.html#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="vooruikijken-massaspectrometrie.html#cb22-5" tabindex="-1"></a><span class="co"># Installeer benodigde pakketten</span></span>
<span id="cb22-6"><a href="vooruikijken-massaspectrometrie.html#cb22-6" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="fu">c</span>(<span class="st">&quot;pRoloc&quot;</span>, <span class="st">&quot;pRolocdata&quot;</span>, <span class="st">&quot;Rtsne&quot;</span>, <span class="st">&quot;pheatmap&quot;</span>))</span>
<span id="cb22-7"><a href="vooruikijken-massaspectrometrie.html#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="vooruikijken-massaspectrometrie.html#cb22-8" tabindex="-1"></a><span class="co"># Nu laad ik de pakketten:</span></span>
<span id="cb22-9"><a href="vooruikijken-massaspectrometrie.html#cb22-9" tabindex="-1"></a></span>
<span id="cb22-10"><a href="vooruikijken-massaspectrometrie.html#cb22-10" tabindex="-1"></a><span class="fu">library</span>(pRoloc)</span>
<span id="cb22-11"><a href="vooruikijken-massaspectrometrie.html#cb22-11" tabindex="-1"></a><span class="fu">library</span>(pRolocdata)</span>
<span id="cb22-12"><a href="vooruikijken-massaspectrometrie.html#cb22-12" tabindex="-1"></a><span class="fu">library</span>(Rtsne)</span>
<span id="cb22-13"><a href="vooruikijken-massaspectrometrie.html#cb22-13" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span></code></pre></div>
</div>
<div id="stap-2-laad-de-dunkley2006-dataset" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Stap 2: Laad de dunkley2006 dataset<a href="vooruikijken-massaspectrometrie.html#stap-2-laad-de-dunkley2006-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ik laad de <code>dunkley2006</code> dataset. Deze bevat een <code>MSnSe</code>t object met eiwitexpressies over meerdere fracties.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="vooruikijken-massaspectrometrie.html#cb23-1" tabindex="-1"></a><span class="fu">data</span>(dunkley2006)</span>
<span id="cb23-2"><a href="vooruikijken-massaspectrometrie.html#cb23-2" tabindex="-1"></a>dunkley2006  <span class="co"># Toont samenvatting van het MSnSet object</span></span></code></pre></div>
<pre><code>## MSnSet (storageMode: lockedEnvironment)
## assayData: 689 features, 16 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: M1F1A M1F4A ... M2F11B (16 total)
##   varLabels: membrane.prep fraction replicate
##   varMetadata: labelDescription
## featureData
##   featureNames: AT1G09210 AT1G21750 ... AT4G39080 (689 total)
##   fvarLabels: assigned evidence ... markers (8 total)
##   fvarMetadata: labelDescription
## experimentData: use &#39;experimentData(object)&#39;
##   pubMedIds: 16618929 
## Annotation:  
## - - - Processing information - - -
## Loaded on Thu Jul 16 22:53:08 2015. 
## Normalised to sum of intensities. 
## Added markers from  &#39;mrk&#39; marker vector. Thu Jul 16 22:53:08 2015 
##  MSnbase version: 1.17.12</code></pre>
</div>
<div id="stap-3-eerste-verkenning-van-de-dataset" class="section level3 hasAnchor" number="3.8.3">
<h3><span class="header-section-number">3.8.3</span> Stap 3: Eerste verkenning van de dataset<a href="vooruikijken-massaspectrometrie.html#stap-3-eerste-verkenning-van-de-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ik begin met het verkennen van de structuur van de data:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="vooruikijken-massaspectrometrie.html#cb25-1" tabindex="-1"></a><span class="co"># Dimensies: aantal eiwitten (features) × aantal metingen (samples)</span></span>
<span id="cb25-2"><a href="vooruikijken-massaspectrometrie.html#cb25-2" tabindex="-1"></a><span class="fu">dim</span>(dunkley2006)</span></code></pre></div>
<pre><code>## [1] 689  16</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="vooruikijken-massaspectrometrie.html#cb27-1" tabindex="-1"></a><span class="co"># Bekijk de eerste paar rijen van de eiwit-annotaties (featureData)</span></span>
<span id="cb27-2"><a href="vooruikijken-massaspectrometrie.html#cb27-2" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fData</span>(dunkley2006))</span></code></pre></div>
<pre><code>##           assigned  evidence method   new pd.2013 pd.markers markers.orig
## AT1G09210       ER predicted  PLSDA known      ER   ER lumen           ER
## AT1G21750       ER predicted  PLSDA known      ER   ER lumen           ER
## AT1G51760       ER   unknown  PLSDA   new      ER   ER lumen      unknown
## AT1G56340       ER predicted  PLSDA known      ER   ER lumen           ER
## AT2G32920       ER predicted  PLSDA known      ER   ER lumen           ER
## AT2G47470       ER predicted  PLSDA known      ER   ER lumen           ER
##            markers
## AT1G09210 ER lumen
## AT1G21750 ER lumen
## AT1G51760 ER lumen
## AT1G56340 ER lumen
## AT2G32920 ER lumen
## AT2G47470 ER lumen</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="vooruikijken-massaspectrometrie.html#cb29-1" tabindex="-1"></a><span class="co"># Bekijk hoeveel eiwitten zijn gelabeld per subcellulaire locatie</span></span>
<span id="cb29-2"><a href="vooruikijken-massaspectrometrie.html#cb29-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">fData</span>(dunkley2006)<span class="sc">$</span>markers)</span></code></pre></div>
<pre><code>## 
##      ER lumen   ER membrane         Golgi Mitochondrion       Plastid 
##            14            45            28            55            20 
##            PM      Ribosome           TGN       unknown       vacuole 
##            46            19            13           428            21</code></pre>
<p>Er zijn honderden eiwitten en een aantal daarvan zijn al gelabeld met bekende subcellulaire locaties, wat nuttig is voor supervised learning.</p>
</div>
<div id="stap-4-pca-plot-van-eiwitexpressie" class="section level3 hasAnchor" number="3.8.4">
<h3><span class="header-section-number">3.8.4</span> Stap 4: PCA-plot van eiwitexpressie<a href="vooruikijken-massaspectrometrie.html#stap-4-pca-plot-van-eiwitexpressie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Met Principal Component Analysis (PCA) reduceer ik de dimensies van de dataset zodat ik de clusters van eiwitten kan visualiseren.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="vooruikijken-massaspectrometrie.html#cb31-1" tabindex="-1"></a><span class="co"># Genereer een PCA-plot waarbij de eiwitten gekleurd zijn volgens hun &#39;marker&#39; label</span></span>
<span id="cb31-2"><a href="vooruikijken-massaspectrometrie.html#cb31-2" tabindex="-1"></a><span class="fu">plot2D</span>(dunkley2006, <span class="at">method =</span> <span class="st">&quot;PCA&quot;</span>, <span class="at">fcol =</span> <span class="st">&quot;markers&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/bb-1.png" width="672" /></p>
<p><em>Figuur 10: PCA-plot van eiwitexpressie uit <code>dunkley2006</code> dataset. De assen tonen de eerste twee principal components, die samenvattingen zijn van de verschillen tussen spectra.</em></p>
<p>In de PCA-plot zie ik duidelijk clustering van eiwitten met dezelfde subcellulaire lokalisatie, wat erop wijst dat de data geschikt is voor classificatie.</p>
</div>
<div id="stap-5-t-sne-voor-niet-lineaire-visualisatie" class="section level3 hasAnchor" number="3.8.5">
<h3><span class="header-section-number">3.8.5</span> Stap 5: t-SNE voor niet-lineaire visualisatie<a href="vooruikijken-massaspectrometrie.html#stap-5-t-sne-voor-niet-lineaire-visualisatie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Met t-SNE kan ik expressiedata visualiseren op een manier die niet-lineaire patronen beter laat zien dan PCA. Dit kan leiden tot duidelijkere clusters.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="vooruikijken-massaspectrometrie.html#cb32-1" tabindex="-1"></a><span class="co"># Zet een seed voor reproduceerbare resultaten</span></span>
<span id="cb32-2"><a href="vooruikijken-massaspectrometrie.html#cb32-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-3"><a href="vooruikijken-massaspectrometrie.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="vooruikijken-massaspectrometrie.html#cb32-4" tabindex="-1"></a><span class="co"># Bereken t-SNE met een perplexity-waarde van 30</span></span>
<span id="cb32-5"><a href="vooruikijken-massaspectrometrie.html#cb32-5" tabindex="-1"></a>tsne_res <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(<span class="fu">exprs</span>(dunkley2006), <span class="at">perplexity =</span> <span class="dv">30</span>)</span>
<span id="cb32-6"><a href="vooruikijken-massaspectrometrie.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="vooruikijken-massaspectrometrie.html#cb32-7" tabindex="-1"></a><span class="co"># Plot de t-SNE resultaten en kleur de eiwitten op basis van hun marker</span></span>
<span id="cb32-8"><a href="vooruikijken-massaspectrometrie.html#cb32-8" tabindex="-1"></a><span class="fu">plot</span>(tsne_res<span class="sc">$</span>Y,</span>
<span id="cb32-9"><a href="vooruikijken-massaspectrometrie.html#cb32-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">as.factor</span>(<span class="fu">fData</span>(dunkley2006)<span class="sc">$</span>markers),</span>
<span id="cb32-10"><a href="vooruikijken-massaspectrometrie.html#cb32-10" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb32-11"><a href="vooruikijken-massaspectrometrie.html#cb32-11" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;t-SNE: eiwitlokalisatie&quot;</span>,</span>
<span id="cb32-12"><a href="vooruikijken-massaspectrometrie.html#cb32-12" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t-SNE 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;t-SNE 2&quot;</span>)</span>
<span id="cb32-13"><a href="vooruikijken-massaspectrometrie.html#cb32-13" tabindex="-1"></a></span>
<span id="cb32-14"><a href="vooruikijken-massaspectrometrie.html#cb32-14" tabindex="-1"></a><span class="co"># Voeg een legenda toe</span></span>
<span id="cb32-15"><a href="vooruikijken-massaspectrometrie.html#cb32-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(<span class="fu">fData</span>(dunkley2006)<span class="sc">$</span>markers)),</span>
<span id="cb32-16"><a href="vooruikijken-massaspectrometrie.html#cb32-16" tabindex="-1"></a>       <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">fData</span>(dunkley2006)<span class="sc">$</span>markers)), <span class="at">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/tE-1.png" width="672" /></p>
<p><em>Figuur 11 : t-SNE-plot van de <code>dunkley2006</code> dataset. Elk punt stelt een spectrum voor. Nabijheid in de plot suggereert gelijkaardige piekpatronen. De methode is gevoelig voor lokale structuren in de data.</em></p>
<p>De t-SNE plot laat zien dat veel eiwitten met dezelfde lokalisatie bij elkaar gegroepeerd worden in 2D-ruimte.</p>
</div>
<div id="stap-6-heatmap-van-eiwitexpressie" class="section level3 hasAnchor" number="3.8.6">
<h3><span class="header-section-number">3.8.6</span> Stap 6: Heatmap van eiwitexpressie<a href="vooruikijken-massaspectrometrie.html#stap-6-heatmap-van-eiwitexpressie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Om een overzicht te krijgen van de expressie van de eerste 50 eiwitten, maak ik een heatmap.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="vooruikijken-massaspectrometrie.html#cb33-1" tabindex="-1"></a><span class="co"># Genereer een heatmap van de expressie van de eerste 50 eiwitten</span></span>
<span id="cb33-2"><a href="vooruikijken-massaspectrometrie.html#cb33-2" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">exprs</span>(dunkley2006)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ],</span>
<span id="cb33-3"><a href="vooruikijken-massaspectrometrie.html#cb33-3" tabindex="-1"></a>         <span class="at">show_rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-4"><a href="vooruikijken-massaspectrometrie.html#cb33-4" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Expressie heatmap van eerste 50 eiwitten&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/heatma-1.png" width="672" /></p>
<p><em>Figuur 11: Een heatmap met de <code>dunkley2006</code> dataset.</em></p>
<p>De heatmap helpt bij het visualiseren van patronen in expressie over de verschillende fractionele metingen.</p>
</div>
</div>
<div id="zelf-grafieken-maken" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> 6. Zelf grafieken maken<a href="vooruikijken-massaspectrometrie.html#zelf-grafieken-maken" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aller laatst heb ik geprobeerd zelf een gemiddeld massaspectrumspectrum en chromatogram te maken zonder datasets of packages te gebruiken.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="vooruikijken-massaspectrometrie.html#cb34-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb34-2"><a href="vooruikijken-massaspectrometrie.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="vooruikijken-massaspectrometrie.html#cb34-3" tabindex="-1"></a><span class="co"># Simuleer massa (m/z) waarden</span></span>
<span id="cb34-4"><a href="vooruikijken-massaspectrometrie.html#cb34-4" tabindex="-1"></a>mz_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">400</span>, <span class="dv">1600</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb34-5"><a href="vooruikijken-massaspectrometrie.html#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="vooruikijken-massaspectrometrie.html#cb34-6" tabindex="-1"></a><span class="co"># Simuleer intensiteiten met enkele pieken</span></span>
<span id="cb34-7"><a href="vooruikijken-massaspectrometrie.html#cb34-7" tabindex="-1"></a>intensities <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(mz_values, <span class="at">mean =</span> <span class="dv">700</span>, <span class="at">sd =</span> <span class="dv">20</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span></span>
<span id="cb34-8"><a href="vooruikijken-massaspectrometrie.html#cb34-8" tabindex="-1"></a>               <span class="fu">dnorm</span>(mz_values, <span class="at">mean =</span> <span class="dv">900</span>, <span class="at">sd =</span> <span class="dv">15</span>) <span class="sc">*</span> <span class="dv">150</span> <span class="sc">+</span></span>
<span id="cb34-9"><a href="vooruikijken-massaspectrometrie.html#cb34-9" tabindex="-1"></a>               <span class="fu">dnorm</span>(mz_values, <span class="at">mean =</span> <span class="dv">1200</span>, <span class="at">sd =</span> <span class="dv">30</span>) <span class="sc">*</span> <span class="dv">70</span> <span class="sc">+</span></span>
<span id="cb34-10"><a href="vooruikijken-massaspectrometrie.html#cb34-10" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="fu">length</span>(mz_values), <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb34-11"><a href="vooruikijken-massaspectrometrie.html#cb34-11" tabindex="-1"></a></span>
<span id="cb34-12"><a href="vooruikijken-massaspectrometrie.html#cb34-12" tabindex="-1"></a><span class="fu">plot</span>(mz_values, intensities, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb34-13"><a href="vooruikijken-massaspectrometrie.html#cb34-13" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;m/z (massa/charge)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Intensiteit&quot;</span>,</span>
<span id="cb34-14"><a href="vooruikijken-massaspectrometrie.html#cb34-14" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gemiddeld spectrum&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/spectrum-1.png" width="672" /></p>
<p><em>Figuur 12: Gemiddeld massaspectrumspectrum met pieken bij verschillende massa’s.</em></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="vooruikijken-massaspectrometrie.html#cb35-1" tabindex="-1"></a><span class="co"># Simuleer retentietijden (minuten)</span></span>
<span id="cb35-2"><a href="vooruikijken-massaspectrometrie.html#cb35-2" tabindex="-1"></a>rt_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb35-3"><a href="vooruikijken-massaspectrometrie.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="vooruikijken-massaspectrometrie.html#cb35-4" tabindex="-1"></a><span class="co"># Simuleer intensiteit met enkele pieken in retentietijd</span></span>
<span id="cb35-5"><a href="vooruikijken-massaspectrometrie.html#cb35-5" tabindex="-1"></a>intensity_rt <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(rt_values, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="fl">1.5</span>) <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span></span>
<span id="cb35-6"><a href="vooruikijken-massaspectrometrie.html#cb35-6" tabindex="-1"></a>                <span class="fu">dnorm</span>(rt_values, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">1200</span> <span class="sc">+</span></span>
<span id="cb35-7"><a href="vooruikijken-massaspectrometrie.html#cb35-7" tabindex="-1"></a>                <span class="fu">dnorm</span>(rt_values, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">900</span> <span class="sc">+</span></span>
<span id="cb35-8"><a href="vooruikijken-massaspectrometrie.html#cb35-8" tabindex="-1"></a>                <span class="fu">rnorm</span>(<span class="fu">length</span>(rt_values), <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">30</span>)</span>
<span id="cb35-9"><a href="vooruikijken-massaspectrometrie.html#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="vooruikijken-massaspectrometrie.html#cb35-10" tabindex="-1"></a><span class="fu">plot</span>(rt_values, intensity_rt, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb35-11"><a href="vooruikijken-massaspectrometrie.html#cb35-11" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Retentietijd (minuten)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Intensiteit&quot;</span>,</span>
<span id="cb35-12"><a href="vooruikijken-massaspectrometrie.html#cb35-12" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Gemiddeld chromatogram&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/chroom-1.png" width="672" /></p>
<p><em>Figuur 13: Een chromatorgram. Op de y-as is de Intensiteit arbitraire eenheden (relatieve ionenintensiteit) en op de x-as is de retention time in seconden (s) te zien</em></p>
</div>
<div id="reflectie" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Reflectie:<a href="vooruikijken-massaspectrometrie.html#reflectie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Voor deze vrije ruimte opdracht heb ik eerst een technische workshop gevolgd van ongeveer vier uur. Tijdens die workshop heb ik de massaspectrometer in het echt gezien en een experiment ermee uitgevoerd. Voorafgaand aan de workshop heb ik mezelf goed voorbereid door uitlegvideo’s over massaspectrometrie te bekijken. Deze voorbereiding, samen met de workshop, heeft mij in totaal ongeveer tien uur studie opgeleverd.</p>
<p>Het moeilijkste onderdeel was het vinden en bestuderen van geschikte R-pakketten om massaspectrometrie-data te analyseren, en tegelijkertijd te proberen te werken met een eenvoudige dataset. Dit heeft mij veel tijd gekost, ongeveer vijftien uur. De laatste vijf uur heb ik extra analyses geprobeerd te doen op een andere dataset, maar het was vaak lastig om geschikte open data te vinden voor massaspectrometrie. Sommige bestanden waren beschadigd of moeilijk leesbaar, waardoor ik ze niet kon gebruiken.</p>
<p>Daarom heb ik uiteindelijk gekozen om een eenvoudige dataset te gebruiken die direct beschikbaar is in R, zoals die uit het <code>pRolocdata</code>-pakket. Daarnaast heb ik onderzocht welke mogelijkheden er zijn om in de toekomst verdere analyses te proberen en welke data beter geschikt kunnen zijn.</p>
</div>
<div id="bronnen" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Bronnen<a href="vooruikijken-massaspectrometrie.html#bronnen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Gatto, L., &amp; Lilley, K. S. (2012). <em>MSnbase - an R/Bioconductor package for isobaric tagged mass spectrometry data visualization, processing and quantitation</em>. Bioinformatics, 28(2), 288–289. <a href="https://doi.org/10.1093/bioinformatics/btr645" class="uri">https://doi.org/10.1093/bioinformatics/btr645</a></p></li>
<li><p>Bioconductor project. <em>MSnbase</em>. Geraadpleegd via: <a href="https://bioconductor.org/packages/MSnbase" class="uri">https://bioconductor.org/packages/MSnbase</a></p></li>
<li><p>Bioconductor project. <em>Spectra</em>. Geraadpleegd via: <a href="https://bioconductor.org/packages/Spectra" class="uri">https://bioconductor.org/packages/Spectra</a></p></li>
<li><p>Bioconductor project. <em>msdata</em>. Geraadpleegd via: <a href="https://bioconductor.org/packages/msdata" class="uri">https://bioconductor.org/packages/msdata</a></p></li>
<li><p>Tyanova, S., Temu, T., &amp; Cox, J. (2016). <em>The MaxQuant computational platform for mass spectrometry–based shotgun proteomics</em>. Nature Protocols, 11(12), 2301–2319. <a href="https://doi.org/10.1038/nprot.2016.136" class="uri">https://doi.org/10.1038/nprot.2016.136</a></p></li>
<li><p>ProteomeXchange Consortium. <em>PRIDE database</em>. Geraadpleegd via: <a href="https://www.ebi.ac.uk/pride/" class="uri">https://www.ebi.ac.uk/pride/</a></p></li>
<li><p>Wikipedia contributors. (2024). <em>Mass spectrometry</em>. In Wikipedia, The Free Encyclopedia. Geraadpleegd op 24 mei 2025, van <a href="https://en.wikipedia.org/wiki/Mass_spectrometry" class="uri">https://en.wikipedia.org/wiki/Mass_spectrometry</a></p></li>
<li><p>StackOverflow. Diverse antwoorden over gebruik van MSnbase en Spectra-pakketten in R. Geraadpleegd tussen mei 2024 en mei 2025.</p></li>
<li><p>Tutorials van Bioconductor: <em>Introduction to MSnbase and Spectra</em>. Geraadpleegd via: <a href="https://rdrr.io/bioc/MSnbase/f/vignettes/v01-MSnbase-demo.Rmd" class="uri">https://rdrr.io/bioc/MSnbase/f/vignettes/v01-MSnbase-demo.Rmd</a></p></li>
<li><p>Hogeschool Utrecht. (2025). <em>Figuur 1 t/m 3 afkomstig uit de cursus Projecticum Biomolecular Research, semester 5, Blok C – Tech-workshop G: Mass spectrometry.</em> Geraadpleegd op 24 mei 2025 van: <a href="https://canvas.hu.nl/courses/44565/pages/tech-workshop-g-mass-spectrometry" class="uri">https://canvas.hu.nl/courses/44565/pages/tech-workshop-g-mass-spectrometry</a></p></li>
</ul>
<p>Dit rapport is tot stand gekomen met hulp van ChatGPT (OpenAI). Het schrijven van de codes bij sommige stukjes was zonder deze ondersteuning erg lastig.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="curriculum-vitae.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="guerilla-analytics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
